<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>microDOS(2) | Precision Psychedelics, Simplified.</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- IMask.js for Input Masking -->
    <script src="https://unpkg.com/imask"></script>
    
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* Slate 900 */
            color: #d1d5db; /* Default text color changed for better contrast */
        }
        .gradient-text {
            background: linear-gradient(to right, #7dd3fc, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .btn-primary {
            background: linear-gradient(to right, #38bdf8, #8b5cf6);
            transition-property: transform, box-shadow;
            transition-duration: 0.3s;
            transition-timing-function: ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(56, 189, 248, 0.2), 0 4px 6px -2px rgba(139, 92, 246, 0.1);
        }
        .btn-primary:disabled {
            background: #334155;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .btn-secondary {
            background-color: #334155; /* Slate 700 */
            border: 1px solid #475569; /* Slate 600 */
            transition: background-color 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: #475569; /* Slate 600 */
        }
        .card-bg {
            background-color: #1e293b; /* Slate 800 */
        }
        .pricing-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .pricing-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04), 0 0 0 1px rgba(125, 211, 252, 0.5);
        }
        .feature-icon {
            background: rgba(56, 189, 248, 0.1);
            border-radius: 9999px;
            padding: 12px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .input-field {
            background-color: #1e293b; /* Slate 800 */
            border: 1px solid #334155; /* Slate 700 */
            color: #cbd5e1; /* Slate 300 */
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            transition: border-color 0.3s ease;
        }
        .input-field:focus {
            outline: none;
            border-color: #38bdf8; /* Sky 500 */
        }
        .input-field.is-invalid {
            border-color: #f87171; /* Red 400 */
        }
        .error-message {
            color: #f87171; /* Red 400 */
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: none; /* Initially hidden */
        }
        .step-active {
            color: #7dd3fc;
            border-bottom-color: #7dd3fc;
        }
        .step-inactive {
            color: #64748b; /* Slate 500 */
            border-bottom-color: transparent;
        }
        .video-dot {
            cursor: pointer;
            height: 12px;
            width: 12px;
            margin: 0 4px;
            background-color: #475569; /* Slate 600 */
            border-radius: 50%;
            display: inline-block;
            transition: background-color 0.6s ease;
            border: 2px solid transparent;
        }
        .video-dot:focus {
            outline: none;
            border-color: #7dd3fc;
        }
        .video-dot.active, .video-dot:hover {
            background-color: #7dd3fc; /* Sky 300 */
        }
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        /* Toast Notification */
        #toast-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translate(-50%, -150%);
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid #334155;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            z-index: 100;
            transition: transform 0.5s ease-in-out;
            display: flex;
            align-items: center;
        }
        #toast-notification.show {
            transform: translate(-50%, 0);
        }
        /* Testimonial Carousel */
        .testimonial-carousel {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        .testimonial-card {
            flex: 0 0 100%;
            box-sizing: border-box;
        }
        @media (min-width: 768px) {
            .testimonial-card {
                flex: 0 0 calc(100% / 3);
            }
        }
        /* Video iframe styling */
        .video-iframe {
            width: 100%;
            height: 100%;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); /* shadow-2xl */
            position: absolute;
            top: 0;
            left: 0;
            transition: opacity 1s ease;
        }
        
        /* --- Subscription Toggle Styles --- */
        .sub-toggle-bg {
            background-color: #334155; /* Slate 700 */
        }
        .sub-toggle-btn {
            transition: color 0.3s ease;
        }
        .sub-toggle-btn.active {
            color: #ffffff; /* White text for active state */
        }
        .sub-toggle-btn:not(.active) {
            color: #94a3b8; /* Slate 400 for inactive state */
        }
        .sub-toggle-slider {
            position: absolute;
            top: 2px;
            bottom: 2px;
            width: calc(50% - 2px);
            left: 2px;
            /* Use the primary button gradient for a strong visual indicator */
            background: linear-gradient(to right, #38bdf8, #8b5cf6);
            border-radius: 0.375rem; /* rounded-md */
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        #sub-toggle-monthly:checked ~ .sub-toggle-bg .sub-toggle-slider {
            transform: translateX(0%);
        }
        #sub-toggle-biweekly:checked ~ .sub-toggle-bg .sub-toggle-slider {
            transform: translateX(calc(100%));
        }
    </style>
</head>
<body class="antialiased">
    <!-- Toast Notification element -->
    <div id="toast-notification">
        <svg class="w-5 h-5 mr-3 text-green-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>
        <span id="toast-message"></span>
    </div>

    <!-- Header -->
    <header class="sticky top-0 z-50 bg-slate-900/70 backdrop-blur-lg border-b border-slate-800">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-white">microDOS<span class="gradient-text">(2)</span></div>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#benefits" class="text-slate-300 hover:text-white">Benefits</a>
                <a href="#reviews" class="text-slate-300 hover:text-white">Reviews</a>
                <a href="#how-it-works" class="text-slate-300 hover:text-white">How It Works</a>
                <a href="#pricing" class="text-slate-300 hover:text-white">Pricing</a>
                <a href="#faq" class="text-slate-300 hover:text-white">FAQ</a>
            </div>
            <a href="#pricing" class="hidden md:inline-block px-6 py-2 text-white font-semibold rounded-lg shadow-md btn-primary">
                Get Started
            </a>
            <button id="mobile-menu-button" class="md:hidden p-2 rounded-md text-slate-400 hover:text-white hover:bg-slate-700">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
            </button>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4 space-y-2">
            <a href="#benefits" class="block text-slate-300 hover:text-white py-2">Benefits</a>
            <a href="#reviews" class="block text-slate-300 hover:text-white py-2">Reviews</a>
            <a href="#how-it-works" class="block text-slate-300 hover:text-white py-2">How It Works</a>
            <a href="#pricing" class="block text-slate-300 hover:text-white py-2">Pricing</a>
            <a href="#faq" class="block text-slate-300 hover:text-white py-2">FAQ</a>
            <a href="#pricing" class="block mt-4 w-full text-center px-6 py-3 text-white font-semibold rounded-lg shadow-md btn-primary">
                Get Started
            </a>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="bg-slate-900 py-20 md:py-28">
            <div class="container mx-auto px-6 text-center">
                <h1 id="hero-title" class="text-4xl md:text-6xl font-extrabold tracking-tighter text-white mb-4 transition-opacity duration-500">
                    <!-- This will be updated by JS -->
                </h1>
                <p id="hero-subtitle" class="text-lg md:text-xl text-slate-300 max-w-3xl mx-auto mb-8 transition-opacity duration-500">
                    <!-- This will be updated by JS -->
                </p>
                <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                    <a href="#checkout" data-plan="trial" class="purchase-btn w-full sm:w-auto px-8 py-4 text-lg text-white font-bold rounded-lg shadow-lg btn-primary transform hover:scale-105">
                        Start Your $9.99 Trial
                    </a>
                    <a href="#how-it-works" class="w-full sm:w-auto px-8 py-4 text-lg font-semibold text-white bg-slate-700 border border-slate-600 rounded-lg shadow-md hover:bg-slate-600 transition-colors">
                        Learn More
                    </a>
                </div>
                <div class="mt-16 max-w-2xl mx-auto aspect-video relative">
                    <!-- Video container for transitions -->
                    <div id="video-container" class="w-full h-full">
                        <!-- Videos will be injected here by JS -->
                    </div>
                </div>
                <div id="video-dots" class="text-center mt-6">
                    <!-- Dots will be inserted here by JS -->
                </div>
            </div>
        </section>

        <!-- Benefits Section -->
        <section id="benefits" class="py-20 bg-slate-900/70">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <span class="text-sky-400 font-semibold">THE MICRODOS ADVANTAGE</span>
                    <h2 class="text-3xl md:text-4xl font-bold text-white mt-2">A Cleaner, Clearer Experience</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="text-center p-6 card-bg rounded-xl border border-slate-800">
                        <div class="inline-flex feature-icon mb-4">
                           <svg class="w-8 h-8 text-sky-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        </div>
                        <h3 class="text-xl font-semibold text-white mb-2">Rapid Onset</h3>
                        <p class="text-slate-400">Effects begin in ~10 minutes for predictability.</p>
                    </div>
                    <div class="text-center p-6 card-bg rounded-xl border border-slate-800">
                        <div class="inline-flex feature-icon mb-4">
                            <svg class="w-8 h-8 text-sky-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.085a2 2 0 00-1.736.97l-2.714 4.224a2 2 0 00.174 2.573V10h4z"></path></svg>
                        </div>
                        <h3 class="text-xl font-semibold text-white mb-2">No Nausea</h3>
                        <p class="text-slate-400">â€” A clean, comfortable experience</p>
                    </div>
                    <div class="text-center p-6 card-bg rounded-xl border border-slate-800">
                        <div class="inline-flex feature-icon mb-4">
                           <svg class="w-8 h-8 text-sky-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </div>
                        <h3 class="text-xl font-semibold text-white mb-2">Precision Dose</h3>
                        <p class="text-slate-400">Each pill is scored for convenience.</p>
                    </div>
                    <div class="text-center p-6 card-bg rounded-xl border border-slate-800">
                        <div class="inline-flex feature-icon mb-4">
                            <svg class="w-8 h-8 text-sky-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                        </div>
                        <h3 class="text-xl font-semibold text-white mb-2">Legal & Safe</h3>
                        <p class="text-slate-400">Not federally scheduled.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Product Specs Section -->
        <section class="py-10 bg-slate-800/50">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-2xl font-bold text-white text-center mb-8">Product Specifications</h2>
                 <div class="flex flex-col md:flex-row justify-center gap-8 md:gap-16">
                    <div>
                        <p class="text-slate-400 font-semibold uppercase tracking-wider text-sm">Active Compound</p>
                        <p class="text-lg font-bold text-white">2mg Metocin (4-HO-MET)</p>
                    </div>
                    <div>
                        <p class="text-slate-400 font-semibold uppercase tracking-wider text-sm">Form</p>
                        <p class="text-lg font-bold text-white">Scored, Non-Chewable Pill</p>
                    </div>
                     <div>
                        <p class="text-slate-400 font-semibold uppercase tracking-wider text-sm">Shipping</p>
                        <p class="text-lg font-bold text-white">Discreet, within 48 hours</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section id="how-it-works" class="py-20 bg-slate-900">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl md:text-4xl font-bold text-white text-center mb-16">Get Started in 3 Simple Steps</h2>
                <div class="relative max-w-4xl mx-auto">
                    <div class="hidden md:block absolute top-10 left-0 w-full h-0.5 bg-slate-700"></div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-12 relative">
                        <div class="text-center">
                            <div class="relative mb-4">
                                <div class="inline-flex items-center justify-center w-20 h-20 rounded-full bg-slate-800 text-sky-400 text-2xl font-bold border-4 border-slate-700 shadow-md">1</div>
                            </div>
                            <h3 class="text-xl font-semibold text-white mb-2">Choose Your Plan</h3>
                            <p class="text-slate-400">Start with our risk-free trial or subscribe to save on monthly refills.</p>
                        </div>
                        <div class="text-center">
                            <div class="relative mb-4">
                                <div class="inline-flex items-center justify-center w-20 h-20 rounded-full bg-slate-800 text-sky-400 text-2xl font-bold border-4 border-slate-700 shadow-md">2</div>
                            </div>
                            <h3 class="text-xl font-semibold text-white mb-2">Fast, Discreet Shipping</h3>
                            <p class="text-slate-400">We ship your order in plain packaging within 48 hours. Your privacy is guaranteed.</p>
                        </div>
                        <div class="text-center">
                            <div class="relative mb-4">
                                <div class="inline-flex items-center justify-center w-20 h-20 rounded-full bg-slate-800 text-sky-400 text-2xl font-bold border-4 border-slate-700 shadow-md">3</div>
                            </div>
                            <h3 class="text-xl font-semibold text-white mb-2">Experience Clarity</h3>
                            <p class="text-slate-400">Take one pill for one consistent microdose. Manage your subscription online anytime.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reviews / Social Proof Section -->
        <section id="reviews" class="py-20 bg-slate-900/70">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl font-bold text-white text-center mb-12">Trusted by thousands for focus and clarity</h2>
                <div class="overflow-hidden">
                    <div id="testimonial-carousel" class="testimonial-carousel">
                        <!-- Testimonials will be injected here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Pricing Section -->
        <section id="pricing" class="py-20 bg-slate-900">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl md:text-4xl font-bold text-white text-center mb-4">Find Your Flow State</h2>
                <p class="text-slate-300 text-center max-w-2xl mx-auto mb-12">Start with a trial, make a one-time purchase, or subscribe for the best value. Cancel or adjust anytime.</p>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 max-w-7xl mx-auto items-start">
                    
                    <!-- Trial Pack Card -->
                    <div class="pricing-card card-bg rounded-xl p-8 border border-slate-800 flex flex-col shadow-lg h-full">
                        <h3 class="text-2xl font-bold text-white mb-2">Trial Pack</h3>
                        <p class="text-slate-400 mb-6 flex-grow">A low-risk introduction.</p>
                        <div class="my-8">
                            <span class="text-5xl font-extrabold text-white">$9.99</span>
                            <span class="text-slate-400">/ one-time</span>
                        </div>
                        <ul class="space-y-3 text-slate-300 text-left mb-8">
                            <li class="flex items-center"><svg class="w-5 h-5 mr-2 text-green-400 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>3 Pills (3 Doses)</li>
                            <li class="flex items-center"><svg class="w-5 h-5 mr-2 text-green-400 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>Free Shipping</li>
                        </ul>
                        <a href="#checkout" data-plan="trial" class="purchase-btn w-full mt-auto btn-secondary text-white font-semibold px-6 py-3 rounded-lg">Start My Trial</a>
                    </div>

                    <!-- One-Time Purchase Card -->
                    <div class="pricing-card card-bg rounded-xl p-8 border border-slate-800 flex flex-col shadow-lg h-full">
                        <h3 class="text-2xl font-bold text-white mb-2">One-Time Purchase</h3>
                        <p class="text-slate-400 mb-6 flex-grow">No commitment. Pay as you go.</p>
                        <div class="space-y-4 my-auto">
                            <a href="#checkout" data-plan="onetime_10" class="purchase-btn block bg-slate-700/50 p-4 rounded-lg hover:bg-slate-700 transition-colors">
                                <p class="font-bold text-white">10 Pills</p>
                                <p><span class="text-2xl font-bold text-white">$45</span> <span class="text-slate-400 text-sm">($4.50/pill)</span></p>
                            </a>
                            <a href="#checkout" data-plan="onetime_15" class="purchase-btn block bg-slate-700/50 p-4 rounded-lg hover:bg-slate-700 transition-colors">
                                <p class="font-bold text-white">15 Pills</p>
                                <p><span class="text-2xl font-bold text-white">$65</span> <span class="text-slate-400 text-sm">($4.33/pill)</span></p>
                            </a>
                            <a href="#checkout" data-plan="onetime_30" class="purchase-btn block bg-slate-700/50 p-4 rounded-lg hover:bg-slate-700 transition-colors">
                                <p class="font-bold text-white">30 Pills</p>
                                <p><span class="text-2xl font-bold text-white">$95</span> <span class="text-slate-400 text-sm">($3.17/pill)</span></p>
                            </a>
                            <a href="#checkout" data-plan="onetime_90" class="purchase-btn block bg-slate-700/50 p-4 rounded-lg hover:bg-slate-700 transition-colors">
                                <p class="font-bold text-white">90 Pills</p>
                                <p><span class="text-2xl font-bold text-white">$225</span> <span class="text-slate-400 text-sm">($2.50/pill)</span></p>
                            </a>
                        </div>
                    </div>

                    <!-- Subscription Card -->
                    <div class="pricing-card card-bg rounded-xl p-8 border-2 border-sky-500 flex flex-col shadow-2xl relative lg:scale-105 h-full">
                         <div class="absolute top-0 right-0 py-1.5 px-4 bg-sky-400 text-white text-xs font-bold rounded-bl-lg">BEST VALUE</div>
                        <h3 class="text-2xl font-bold text-white mb-2">Subscribe & Save</h3>
                        <p class="text-slate-400 mb-4 flex-grow">Automatic refills for the best price.</p>
                        
                        <!-- Subscription Toggle -->
                        <div id="subscription-toggle" class="mb-6">
                            <input type="radio" id="sub-toggle-monthly" name="sub-frequency" class="sr-only" checked>
                            <input type="radio" id="sub-toggle-biweekly" name="sub-frequency" class="sr-only">
                            <div class="relative sub-toggle-bg p-1 rounded-md flex items-center">
                                <div class="sub-toggle-slider"></div>
                                <label for="sub-toggle-monthly" class="relative z-10 w-1/2 text-center text-sm font-semibold cursor-pointer p-1 sub-toggle-btn active">Monthly</label>
                                <label for="sub-toggle-biweekly" class="relative z-10 w-1/2 text-center text-sm font-semibold cursor-pointer p-1 sub-toggle-btn">Bi-weekly</label>
                            </div>
                        </div>

                        <!-- Monthly Prices -->
                        <div id="monthly-prices" class="space-y-4">
                           <a href="#checkout" data-plan="sub_10_monthly" class="purchase-btn block bg-sky-500/20 p-4 rounded-lg hover:bg-sky-500/30 transition-colors">
                                <p class="font-bold text-white">10 Pills / mo <span class="text-sky-400 font-semibold">(Save 15%)</span></p>
                                <p><span class="text-2xl font-bold text-white">$38.25</span> <span class="text-slate-400 text-sm">($3.83/pill)</span></p>
                            </a>
                             <a href="#checkout" data-plan="sub_15_monthly" class="purchase-btn block bg-sky-500/20 p-4 rounded-lg hover:bg-sky-500/30 transition-colors">
                                <p class="font-bold text-white">15 Pills / mo <span class="text-sky-400 font-semibold">(Save 15%)</span></p>
                                <p><span class="text-2xl font-bold text-white">$55.25</span> <span class="text-slate-400 text-sm">($3.68/pill)</span></p>
                            </a>
                             <a href="#checkout" data-plan="sub_30_monthly" class="purchase-btn block bg-sky-500/20 p-4 rounded-lg hover:bg-sky-500/30 transition-colors">
                                <p class="font-bold text-white">30 Pills / mo <span class="text-sky-400 font-semibold">(Save 15%)</span></p>
                                <p><span class="text-2xl font-bold text-white">$80.75</span> <span class="text-slate-400 text-sm">($2.69/pill)</span></p>
                            </a>
                             <a href="#checkout" data-plan="sub_90_monthly" class="purchase-btn block bg-sky-500/20 p-4 rounded-lg hover:bg-sky-500/30 transition-colors">
                                <p class="font-bold text-white">90 Pills / mo <span class="text-sky-400 font-semibold">(Save 20%)</span></p>
                                <p><span class="text-2xl font-bold text-white">$180</span> <span class="text-slate-400 text-sm">($2.00/pill)</span></p>
                            </a>
                        </div>
                        
                        <!-- Bi-weekly Prices -->
                        <div id="biweekly-prices" class="space-y-4 hidden">
                           <a href="#checkout" data-plan="sub_10_biweekly" class="purchase-btn block bg-sky-500/20 p-4 rounded-lg hover:bg-sky-500/30 transition-colors">
                                <p class="font-bold text-white">10 Pills / 2 wks <span class="text-sky-300 font-semibold">(Save 20%)</span></p>
                                <p><span class="text-2xl font-bold text-white">$36.00</span> <span class="text-slate-400 text-sm">($3.60/pill)</span></p>
                            </a>
                             <a href="#checkout" data-plan="sub_15_biweekly" class="purchase-btn block bg-sky-500/20 p-4 rounded-lg hover:bg-sky-500/30 transition-colors">
                                <p class="font-bold text-white">15 Pills / 2 wks <span class="text-sky-300 font-semibold">(Save 20%)</span></p>
                                <p><span class="text-2xl font-bold text-white">$52.00</span> <span class="text-slate-400 text-sm">($3.47/pill)</span></p>
                            </a>
                             <a href="#checkout" data-plan="sub_30_biweekly" class="purchase-btn block bg-sky-500/20 p-4 rounded-lg hover:bg-sky-500/30 transition-colors">
                                <p class="font-bold text-white">30 Pills / 2 wks <span class="text-sky-300 font-semibold">(Save 20%)</span></p>
                                <p><span class="text-2xl font-bold text-white">$76.00</span> <span class="text-slate-400 text-sm">($2.53/pill)</span></p>
                            </a>
                             <a href="#checkout" data-plan="sub_90_biweekly" class="purchase-btn block bg-sky-500/20 p-4 rounded-lg hover:bg-sky-500/30 transition-colors">
                                <p class="font-bold text-white">90 Pills / 2 wks <span class="text-sky-300 font-semibold">(Save 25%)</span></p>
                                <p><span class="text-2xl font-bold text-white">$168.75</span> <span class="text-slate-400 text-sm">($1.88/pill)</span></p>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Checkout Section -->
        <section id="checkout" class="py-20 bg-slate-900/70 hidden">
             <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div id="checkout-container" class="max-w-3xl mx-auto">
                    <!-- Header -->
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold text-white">Secure Checkout</h2>
                    </div>

                    <!-- Step Indicator -->
                    <div class="flex justify-center border-b border-slate-800 mb-12">
                        <div id="step-1-indicator" class="step-active py-4 px-6 text-sm font-semibold border-b-2" aria-current="step">1. Shipping</div>
                        <div id="step-2-indicator" class="step-inactive py-4 px-6 text-sm font-semibold border-b-2">2. Payment</div>
                        <div id="step-3-indicator" class="step-inactive py-4 px-6 text-sm font-semibold border-b-2">3. Confirm</div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                        <!-- Form Section -->
                        <div class="lg:col-span-1">
                            <form id="checkout-form" novalidate>
                                <!-- Step 1: Shipping Information -->
                                <div id="step-1">
                                    <h3 class="text-xl font-bold text-white mb-6">Shipping Information</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="email" class="block text-sm font-medium text-slate-300 mb-1">Email Address</label>
                                            <input type="email" id="email" name="email" class="w-full input-field" placeholder="you@example.com" required>
                                            <p class="error-message" data-for="email"></p>
                                        </div>
                                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                            <div>
                                                <label for="first-name" class="block text-sm font-medium text-slate-300 mb-1">First Name</label>
                                                <input type="text" id="first-name" name="first-name" class="w-full input-field" required>
                                                <p class="error-message" data-for="first-name"></p>
                                            </div>
                                            <div>
                                                <label for="last-name" class="block text-sm font-medium text-slate-300 mb-1">Last Name</label>
                                                <input type="text" id="last-name" name="last-name" class="w-full input-field" required>
                                                <p class="error-message" data-for="last-name"></p>
                                            </div>
                                        </div>
                                        <div>
                                            <label for="address" class="block text-sm font-medium text-slate-300 mb-1">Address</label>
                                            <input type="text" id="address" name="address" class="w-full input-field" placeholder="123 Main St" required>
                                            <p class="error-message" data-for="address"></p>
                                        </div>
                                        <div>
                                            <label for="city" class="block text-sm font-medium text-slate-300 mb-1">City</label>
                                            <input type="text" id="city" name="city" class="w-full input-field" required>
                                            <p class="error-message" data-for="city"></p>
                                        </div>
                                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                                            <div>
                                                <label for="country" class="block text-sm font-medium text-slate-300 mb-1">Country</label>
                                                <select id="country" name="country" class="w-full input-field">
                                                    <option>United States</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label for="state" class="block text-sm font-medium text-slate-300 mb-1">State</label>
                                                <input type="text" id="state" name="state" class="w-full input-field" required>
                                                <p class="error-message" data-for="state"></p>
                                            </div>
                                            <div>
                                                <label for="zip" class="block text-sm font-medium text-slate-300 mb-1">ZIP Code</label>
                                                <input type="text" id="zip" name="zip" class="w-full input-field" required>
                                                <p class="error-message" data-for="zip"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="button" id="to-step-2" class="w-full mt-8 btn-primary text-white font-bold py-3 rounded-lg">Continue to Payment</button>
                                </div>

                                <!-- Step 2: Payment Information -->
                                <div id="step-2" class="hidden">
                                    <h3 class="text-xl font-bold text-white mb-6">Payment Information</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="card-number" class="block text-sm font-medium text-slate-300 mb-1">Card Number</label>
                                            <input type="text" id="card-number" name="card-number" class="w-full input-field" placeholder="0000 0000 0000 0000" required>
                                            <p class="error-message" data-for="card-number"></p>
                                        </div>
                                        <div>
                                            <label for="card-name" class="block text-sm font-medium text-slate-300 mb-1">Name on Card</label>
                                            <input type="text" id="card-name" name="card-name" class="w-full input-field" required>
                                             <p class="error-message" data-for="card-name"></p>
                                        </div>
                                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                            <div>
                                                <label for="expiry-date" class="block text-sm font-medium text-slate-300 mb-1">Expiration Date</label>
                                                <input type="text" id="expiry-date" name="expiry-date" class="w-full input-field" placeholder="MM / YY" required>
                                                <p class="error-message" data-for="expiry-date"></p>
                                            </div>
                                            <div>
                                                <label for="cvc" class="block text-sm font-medium text-slate-300 mb-1">CVC</label>
                                                <input type="text" id="cvc" name="cvc" class="w-full input-field" placeholder="123" required>
                                                <p class="error-message" data-for="cvc"></p>
                                            </div>
                                        </div>
                                    </div>
                                     <div class="mt-8 flex justify-between items-center gap-4">
                                        <button type="button" id="back-to-step-1" class="w-1/3 text-sm text-slate-400 hover:text-white">Back</button>
                                        <button type="button" id="to-step-3" class="w-2/3 btn-primary text-white font-bold py-3 rounded-lg">Review Order</button>
                                    </div>
                                </div>
                                
                                <!-- Step 3: Confirmation -->
                                <div id="step-3" class="hidden">
                                    <h3 class="text-xl font-bold text-white mb-6">Confirm Your Order</h3>
                                    <div class="card-bg border border-slate-700 rounded-lg p-6 space-y-4">
                                        <div>
                                            <h4 class="font-semibold text-white">Shipping To:</h4>
                                            <p id="confirm-name" class="text-slate-300"></p>
                                            <p id="confirm-address" class="text-slate-300"></p>
                                        </div>
                                         <div>
                                            <h4 class="font-semibold text-white">Payment Method:</h4>
                                            <p id="confirm-payment" class="text-slate-300"></p>
                                        </div>
                                        <div class="border-t border-slate-700 pt-4">
                                            <h4 class="font-semibold text-white">Order Summary:</h4>
                                            <div id="confirm-order-summary" class="text-slate-300"></div>
                                        </div>
                                    </div>
                                     <div class="mt-8 flex justify-between items-center gap-4">
                                        <button type="button" id="back-to-step-2" class="w-1/3 text-sm text-slate-400 hover:text-white">Back</button>
                                        <button type="submit" id="confirm-purchase" class="w-2/3 btn-primary text-white font-bold py-3 rounded-lg flex justify-center items-center">
                                            <span class="btn-text">Confirm Purchase</span>
                                            <span class="spinner hidden"></span>
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Order Summary Section -->
                        <div class="lg:col-span-1">
                            <div class="card-bg rounded-lg p-6 border border-slate-800 sticky top-28">
                                <h3 class="text-lg font-bold text-white mb-4">Your Order</h3>
                                <div id="order-summary-content">
                                    <!-- This will be populated by JS -->
                                </div>
                                <div class="border-t border-slate-700 mt-4 pt-4 space-y-2">
                                    <div class="flex justify-between text-slate-300">
                                        <span>Subtotal</span>
                                        <span id="summary-subtotal">$0.00</span>
                                    </div>
                                    <div class="flex justify-between text-slate-300">
                                        <span>Shipping</span>
                                        <span id="summary-shipping">FREE</span>
                                    </div>
                                    <div class="flex justify-between text-white font-bold text-lg">
                                        <span>Total</span>
                                        <span id="summary-total">$0.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Success Message -->
                <div id="success-message" class="hidden text-center card-bg border border-green-500 rounded-lg p-8 max-w-lg mx-auto">
                    <div class="w-16 h-16 mx-auto bg-green-500/10 rounded-full flex items-center justify-center mb-4">
                        <svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                    </div>
                    <h2 class="text-2xl font-bold text-white">Thank You!</h2>
                    <p class="text-slate-300 mt-2">Your order has been placed successfully. A confirmation email is on its way.</p>
                    <button id="reset-checkout-btn" class="inline-block mt-6 text-sm text-sky-400 hover:text-sky-300">Start Over</button>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section id="faq" class="py-20 bg-slate-900">
            <div class="container mx-auto px-6 max-w-3xl">
                <h2 class="text-3xl font-bold text-white text-center mb-12">Frequently Asked Questions</h2>
                <div class="space-y-4" id="faq-container">
                    <div class="card-bg rounded-lg border border-slate-800">
                        <button class="faq-question flex justify-between items-center w-full p-6 text-left font-semibold text-white" aria-expanded="false" aria-controls="faq1-answer">
                            <span>Is this legal?</span>
                            <svg class="faq-arrow w-5 h-5 shrink-0 transition-transform duration-200 text-slate-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                        </button>
                        <div id="faq1-answer" class="faq-answer hidden p-6 pt-0 text-slate-300">The active ingredient, 4-HO-MET, is not federally scheduled in the United States. We recommend checking your local regulations, but we ship to all 50 states.</div>
                    </div>
                    <div class="card-bg rounded-lg border border-slate-800">
                        <button class="faq-question flex justify-between items-center w-full p-6 text-left font-semibold text-white" aria-expanded="false" aria-controls="faq2-answer">
                            <span>What does a microdose feel like?</span>
                            <svg class="faq-arrow w-5 h-5 shrink-0 transition-transform duration-200 text-slate-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                        </button>
                        <div id="faq2-answer" class="faq-answer hidden p-6 pt-0 text-slate-300">Please refer to the <a href="https://docs.google.com/document/d/1UMQnulLEw2pxAjKASeyxIg5OmXUfd80-VKUZelIjYvs/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-sky-400 hover:text-sky-300 underline">'DISCLAIMERS & OTHER INFORMATION'</a> guide that was included in your shipping notification email.</div>
                    </div>
                    <div class="card-bg rounded-lg border border-slate-800">
                        <button class="faq-question flex justify-between items-center w-full p-6 text-left font-semibold text-white" aria-expanded="false" aria-controls="faq3-answer">
                            <span>Is it safe?</span>
                            <svg class="faq-arrow w-5 h-5 shrink-0 transition-transform duration-200 text-slate-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                        </button>
                        <div id="faq3-answer" class="faq-answer hidden p-6 pt-0 text-slate-300">Please refer to the <a href="https://docs.google.com/document/d/1UMQnulLEw2pxAjKASeyxIg5OmXUfd80-VKUZelIjYvs/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-sky-400 hover:text-sky-300 underline">'DISCLAIMERS & OTHER INFORMATION'</a> guide that was included in your shipping notification email.</div>
                    </div>
                    <div class="card-bg rounded-lg border border-slate-800">
                        <button class="faq-question flex justify-between items-center w-full p-6 text-left font-semibold text-white" aria-expanded="false" aria-controls="faq4-answer">
                            <span>Can I cancel my subscription anytime?</span>
                            <svg class="faq-arrow w-5 h-5 shrink-0 transition-transform duration-200 text-slate-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                        </button>
                        <div id="faq4-answer" class="faq-answer hidden p-6 pt-0 text-slate-300">Absolutely. You can pause, modify, or cancel your subscription at any time through your online account portal, with no hidden fees or penalties.</div>
                    </div>
                    <div class="card-bg rounded-lg border border-slate-800">
                        <button class="faq-question flex justify-between items-center w-full p-6 text-left font-semibold text-white" aria-expanded="false" aria-controls="faq7-answer">
                            <span>What is important to know about microdosing?</span>
                            <svg class="faq-arrow w-5 h-5 shrink-0 transition-transform duration-200 text-slate-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                        </button>
                        <div id="faq7-answer" class="faq-answer hidden p-6 pt-0 text-slate-300">Please refer to the <a href="https://docs.google.com/document/d/1UMQnulLEw2pxAjKASeyxIg5OmXUfd80-VKUZelIjYvs/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-sky-400 hover:text-sky-300 underline">'DISCLAIMERS & OTHER INFORMATION'</a> guide that was included in your shipping notification email.</div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 border-t border-slate-800">
        <div class="container mx-auto px-6 py-12">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <div class="text-2xl font-bold text-white mb-2">microDOS<span class="gradient-text">(2)</span></div>
                    <p class="max-w-xs text-slate-400">Precision psychedelics, simplified for the modern mind.</p>
                </div>
                <div class="md:col-span-2 grid grid-cols-2 sm:grid-cols-3 gap-8">
                    <div>
                        <h4 class="font-semibold text-white mb-4">Quick Links</h4>
                        <ul class="space-y-2 text-slate-400">
                            <li><a href="#benefits" class="hover:text-white">Benefits</a></li>
                            <li><a href="#pricing" class="hover:text-white">Pricing</a></li>
                            <li><a href="#faq" class="hover:text-white">FAQ</a></li>
                            <li><a href="#" class="hover:text-white">Contact</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-white mb-4">Legal</h4>
                        <ul class="space-y-2 text-slate-400">
                            <li><a href="https://docs.google.com/document/d/16Z3l0xx-bDygSb5rDf_1lXAVMqxcc2jCumqv39KdLAA/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="hover:text-white">Privacy Policy</a></li>
                            <li><a href="https://docs.google.com/document/d/16Z3l0xx-bDygSb5rDf_1lXAVMqxcc2jCumqv39KdLAA/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="hover:text-white">Terms of Service</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="mt-12 border-t border-slate-700 pt-8 text-center text-slate-500">
                <p class="text-sm mb-4">
                    <strong>Disclaimer:</strong> For research purposes only.
                    <br><br>
                    <strong>Important:</strong> These statements have not been evaluated by the Food and Drug Administration. This product is not intended to diagnose, treat, cure, or prevent any disease.
                </p>
                <p class="text-sm">&copy; 2025 microDOS(2) Inc. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
    
        // --- Code Quality & Maintainability: Modular Functions ---
        
        /**
         * Initializes the rotating hero video background.
         */
        function initVideoRotator() {
             const videoData = [
                {
                    videoId: 'tVmKLPFWsP4',
                    title: 'One Pill. One Dose. <span class="gradient-text">Pure Clarity.</span>',
                    subtitle: 'Legal, fast-acting psychedelic exploration. Our precisely formulated 2mg Metocin tablets are designed for cognitive clarity, perceptual enhancement, and creative flow.'
                },
                {
                    videoId: '7IPRnhIub8I',
                    title: 'Unlock Creative Flow. <span class="gradient-text">Elevate Your Senses.</span>',
                    subtitle: 'Tap into a higher state of focus and inspiration. See your world from a new, enhanced perspective.'
                },
                {
                    videoId: 'nXwnb-ej8J0',
                    title: 'Expand Your Mind. <span class="gradient-text">Discover New Worlds.</span>',
                    subtitle: 'Journey through vibrant landscapes of thought and creativity with our precision-formulated microdoses.'
                },
                {
                    videoId: 'HCzVzK66Nwc',
                    title: 'A New Perspective. <span class="gradient-text">Simplified.</span>',
                    subtitle: 'Experience the world with heightened senses and a clearer, more connected mind.'
                }
            ];

            let currentVideoIndex = 0;
            let videoInterval;

            const videoContainer = document.getElementById('video-container');
            const heroTitle = document.getElementById('hero-title');
            const heroSubtitle = document.getElementById('hero-subtitle');
            const dotsContainer = document.getElementById('video-dots');

            // Pre-create iframe elements for smoother transitions
            videoData.forEach((data, index) => {
                const iframe = document.createElement('iframe');
                const videoSrc = `https://www.youtube.com/embed/${data.videoId}?autoplay=1&mute=1&loop=1&playlist=${data.videoId}&controls=0&showinfo=0&rel=0&modestbranding=1&enablejsapi=1`;
                iframe.src = videoSrc;
                iframe.className = 'video-iframe';
                iframe.setAttribute('frameborder', '0');
                iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
                iframe.style.opacity = index === 0 ? '1' : '0';
                videoContainer.appendChild(iframe);
                data.element = iframe; // Store element reference
            });
            
            function showVideo(index) {
                // Fade out text
                heroTitle.style.opacity = 0;
                heroSubtitle.style.opacity = 0;

                setTimeout(() => {
                    const videoInfo = videoData[index];
                    heroTitle.innerHTML = videoInfo.title;
                    heroSubtitle.textContent = videoInfo.subtitle;
                    
                    // Fade in text
                    heroTitle.style.opacity = 1;
                    heroSubtitle.style.opacity = 1;

                    videoData.forEach((v, i) => {
                        v.element.style.opacity = i === index ? '1' : '0';
                    });

                    document.querySelectorAll('.video-dot').forEach((dot, i) => {
                        dot.classList.toggle('active', i === index);
                    });
                    currentVideoIndex = index;
                }, 500);
            }

            function createDots() {
                videoData.forEach((_, index) => {
                    const dot = document.createElement('button'); // Use button for accessibility
                    dot.classList.add('video-dot');
                    dot.setAttribute('aria-label', `Play video ${index + 1}`);
                    dot.addEventListener('click', () => {
                        showVideo(index);
                        resetInterval();
                    });
                    dotsContainer.appendChild(dot);
                });
            }
            
            function startInterval() {
                videoInterval = setInterval(() => {
                    const nextIndex = (currentVideoIndex + 1) % videoData.length;
                    showVideo(nextIndex);
                }, 7000);
            }

            function resetInterval() {
                clearInterval(videoInterval);
                startInterval();
            }

            createDots();
            showVideo(0);
            startInterval();
        }

        /**
         * Initializes the testimonial carousel.
         */
        function initTestimonialCarousel() {
            const testimonials = [
                { name: 'Alex P.', text: '"Absolutely game-changing for my creative workflow. The focus is clean and consistent without any jitters. Highly recommend."' },
                { name: 'Sarah K.', text: '"I was skeptical, but the trial sold me. It\'s exactly as described - a subtle lift that helps me stay present and productive all day."' },
                { name: 'Mike D.', text: '"The subscription is so convenient, and the product is top-notch. Discreet shipping is a huge plus. My productivity has never been better."' },
                // Add more testimonials here to see the carousel effect
                { name: 'Jess R.', text: '"A perfect tool for deep work sessions. It helps me get into a flow state much faster than coffee ever could."' },
                { name: 'Tom B.', text: '"The clarity is unreal. It\'s not a high, just a better version of my normal self. This is the future."' },
                { name: 'Emily C.', text: '"As an artist, this has been invaluable for breaking through creative blocks. Everything just feels more vibrant and connected."' }
            ];

            const carousel = document.getElementById('testimonial-carousel');
            if (!carousel) return;

            // Duplicate testimonials for a seamless loop
            const allTestimonials = [...testimonials, ...testimonials];

            allTestimonials.forEach(t => {
                const card = document.createElement('div');
                card.className = 'testimonial-card p-4';
                card.innerHTML = `
                    <div class="card-bg p-6 rounded-lg border border-slate-800 shadow-sm h-full flex flex-col">
                        <p class="text-slate-300 mb-4 flex-grow">"${t.text}"</p>
                        <p class="font-bold text-white">- ${t.name}</p>
                    </div>
                `;
                carousel.appendChild(card);
            });
            
            let position = 0;
            const cardWidth = carousel.querySelector('.testimonial-card').offsetWidth;
            
            setInterval(() => {
                position++;
                carousel.style.transition = 'transform 1.5s linear';
                carousel.style.transform = `translateX(-${position * cardWidth}px)`;

                // Reset to the beginning for a seamless loop
                if (position >= testimonials.length) {
                    setTimeout(() => {
                        carousel.style.transition = 'none';
                        position = 0;
                        carousel.style.transform = `translateX(0)`;
                    }, 1500);
                }
            }, 3000);
        }

        /**
         * Initializes the FAQ accordion functionality.
         */
        function initFaqAccordion() {
            const faqContainer = document.getElementById('faq-container');
            if (!faqContainer) return;

            faqContainer.addEventListener('click', (e) => {
                const questionButton = e.target.closest('.faq-question');
                if (!questionButton) return;

                const answer = document.getElementById(questionButton.getAttribute('aria-controls'));
                const isExpanded = questionButton.getAttribute('aria-expanded') === 'true';

                // Close all other open FAQs
                faqContainer.querySelectorAll('.faq-question').forEach(btn => {
                    if (btn !== questionButton) {
                        btn.setAttribute('aria-expanded', 'false');
                        const otherAnswer = document.getElementById(btn.getAttribute('aria-controls'));
                        if (otherAnswer) {
                           otherAnswer.classList.add('hidden');
                        }
                        btn.querySelector('.faq-arrow').classList.remove('rotate-180');
                    }
                });

                // Toggle the clicked FAQ
                questionButton.setAttribute('aria-expanded', !isExpanded);
                answer.classList.toggle('hidden');
                questionButton.querySelector('.faq-arrow').classList.toggle('rotate-180');
            });
        }

        /**
         * Initializes the entire checkout flow, including validation, masking, and state management.
         */
        function initCheckout() {
            const checkoutSection = document.getElementById('checkout');
            if (!checkoutSection) return;

            // --- Updated Plans Object ---
            const plans = {
                trial: { name: 'Trial Pack', price: 9.99, recurring: false, pills: 3, image: 'https://placehold.co/100x100/1e293b/7dd3fc?text=3' },
                // One-time purchases
                onetime_10: { name: 'One-Time Purchase (10 Pills)', price: 45.00, recurring: false, pills: 10, image: 'https://placehold.co/100x100/1e293b/7dd3fc?text=10' },
                onetime_15: { name: 'One-Time Purchase (15 Pills)', price: 65.00, recurring: false, pills: 15, image: 'https://placehold.co/100x100/1e293b/7dd3fc?text=15' },
                onetime_30: { name: 'One-Time Purchase (30 Pills)', price: 95.00, recurring: false, pills: 30, image: 'https://placehold.co/100x100/1e293b/7dd3fc?text=30' },
                onetime_90: { name: 'One-Time Purchase (90 Pills)', price: 225.00, recurring: false, pills: 90, image: 'https://placehold.co/100x100/1e293b/7dd3fc?text=90' },
                // Monthly Subscription purchases
                sub_10_monthly: { name: '10 Pill Monthly Subscription', price: 38.25, recurring: true, pills: 10, image: 'https://placehold.co/100x100/1e293b/38bdf8?text=10' },
                sub_15_monthly: { name: '15 Pill Monthly Subscription', price: 55.25, recurring: true, pills: 15, image: 'https://placehold.co/100x100/1e293b/38bdf8?text=15' },
                sub_30_monthly: { name: '30 Pill Monthly Subscription', price: 80.75, recurring: true, pills: 30, image: 'https://placehold.co/100x100/1e293b/38bdf8?text=30' },
                sub_90_monthly: { name: '90 Pill Monthly Subscription', price: 180.00, recurring: true, pills: 90, image: 'https://placehold.co/100x100/1e293b/38bdf8?text=90' },
                 // Bi-weekly Subscription purchases
                sub_10_biweekly: { name: '10 Pill Bi-weekly Subscription', price: 36.00, recurring: true, pills: 10, image: 'https://placehold.co/100x100/1e293b/8b5cf6?text=10' },
                sub_15_biweekly: { name: '15 Pill Bi-weekly Subscription', price: 52.00, recurring: true, pills: 15, image: 'https://placehold.co/100x100/1e293b/8b5cf6?text=15' },
                sub_30_biweekly: { name: '30 Pill Bi-weekly Subscription', price: 76.00, recurring: true, pills: 30, image: 'https://placehold.co/100x100/1e293b/8b5cf6?text=30' },
                sub_90_biweekly: { name: '90 Pill Bi-weekly Subscription', price: 168.75, recurring: true, pills: 90, image: 'https://placehold.co/100x100/1e293b/8b5cf6?text=90' }
            };

            const state = {
                currentStep: 1,
                selectedPlan: null,
                get planDetails() { return plans[this.selectedPlan]; }
            };

            const checkoutContainer = document.getElementById('checkout-container');
            const successMessage = document.getElementById('success-message');
            const purchaseButtons = document.querySelectorAll('.purchase-btn');
            const form = document.getElementById('checkout-form');
            const toast = document.getElementById('toast-notification');
            const toastMessage = document.getElementById('toast-message');

            const masks = {
                'card-number': IMask(document.getElementById('card-number'), { mask: '0000 0000 0000 0000' }),
                'expiry-date': IMask(document.getElementById('expiry-date'), { mask: 'MM / YY', blocks: { MM: { mask: IMask.MaskedRange, from: 1, to: 12 }, YY: { mask: IMask.MaskedRange, from: String(new Date().getFullYear()).slice(2), to: String(new Date().getFullYear() + 10).slice(2) } } }),
                'cvc': IMask(document.getElementById('cvc'), { mask: '000[0]' })
            };

            const validationRules = {
                'email': { required: true, pattern: /^\S+@\S+\.\S+$/, message: 'Please enter a valid email address.' },
                'first-name': { required: true, message: 'First name is required.' },
                'last-name': { required: true, message: 'Last name is required.' },
                'address': { required: true, message: 'Address is required.' },
                'city': { required: true, message: 'City is required.' },
                'state': { required: true, message: 'State is required.' },
                'zip': { required: true, message: 'ZIP code is required.' },
                'card-number': { required: true, minLength: 19, message: 'Please enter a full card number.' },
                'card-name': { required: true, message: 'Name on card is required.' },
                'expiry-date': { required: true, minLength: 7, message: 'Please enter a valid expiry date.' },
                'cvc': { required: true, minLength: 3, message: 'Please enter a valid CVC.' }
            };

            function validateField(input) {
                const rule = validationRules[input.id];
                const errorEl = form.querySelector(`.error-message[data-for="${input.id}"]`);
                let isValid = true;
                let errorMessage = '';

                if (rule.required && !input.value.trim()) {
                    isValid = false;
                    errorMessage = rule.message;
                } else if (rule.pattern && !rule.pattern.test(input.value)) {
                    isValid = false;
                    errorMessage = rule.message;
                } else if (rule.minLength && input.value.length < rule.minLength) {
                    isValid = false;
                    errorMessage = rule.message;
                }

                input.classList.toggle('is-invalid', !isValid);
                if(errorEl) {
                    errorEl.textContent = errorMessage;
                    errorEl.style.display = isValid ? 'none' : 'block';
                }
                return isValid;
            }

            function validateStep(step) {
                const inputs = form.querySelectorAll(`#step-${step} input, #step-${step} select`);
                let allValid = true;
                inputs.forEach(input => {
                    if (!validateField(input)) {
                        allValid = false;
                    }
                });
                return allValid;
            }
            
            function updateCheckoutUI() {
                form.querySelectorAll('[id^=step-]').forEach(s => s.classList.add('hidden'));
                form.querySelectorAll('[id$="-indicator"]').forEach(i => {
                    i.classList.replace('step-active', 'step-inactive');
                    i.removeAttribute('aria-current');
                });

                document.getElementById(`step-${state.currentStep}`).classList.remove('hidden');
                const activeIndicator = document.getElementById(`step-${state.currentStep}-indicator`);
                activeIndicator.classList.replace('step-inactive', 'step-active');
                activeIndicator.setAttribute('aria-current', 'step');
            }

            function populateOrderSummary() {
                const plan = state.planDetails;
                if (!plan) return;
                
                let frequencyText = '';
                if (plan.recurring) {
                    frequencyText = plan.name.includes('Monthly') ? '/ month' : '/ 2 wks';
                }

                document.getElementById('order-summary-content').innerHTML = `
                    <div class="flex items-start space-x-4">
                        <img src="${plan.image}" alt="${plan.name}" class="w-16 h-16 bg-slate-700 rounded-md flex-shrink-0 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/100x100/1e293b/ffffff?text=Img';">
                        <div class="flex-grow">
                            <p class="font-semibold text-white">${plan.name}</p>
                            <p class="text-sm text-slate-400">${plan.pills} Pills ${frequencyText}</p>
                        </div>
                        <p class="font-semibold text-white">$${plan.price.toFixed(2)}</p>
                    </div>`;
                document.getElementById('summary-subtotal').textContent = `$${plan.price.toFixed(2)}`;
                document.getElementById('summary-total').textContent = `$${plan.price.toFixed(2)}`;
            }

            function populateConfirmation() {
                const plan = state.planDetails;
                document.getElementById('confirm-name').textContent = `${form.elements['first-name'].value} ${form.elements['last-name'].value}`;
                document.getElementById('confirm-address').textContent = `${form.elements['address'].value}, ${form.elements['city'].value}, ${form.elements['state'].value} ${form.elements['zip'].value}`;
                document.getElementById('confirm-payment').textContent = `Card ending in ${masks['card-number'].value.slice(-4)}`;
                document.getElementById('confirm-order-summary').innerHTML = `
                    <div class="flex justify-between"><span>${plan.name}</span><span>$${plan.price.toFixed(2)}</span></div>
                    <div class="flex justify-between mt-2 pt-2 border-t border-slate-600 font-bold"><span>Total</span><span>$${plan.price.toFixed(2)}</span></div>`;
            }

            function showToast(message) {
                toastMessage.textContent = message;
                toast.classList.add('show');
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }

            function showCheckout(planId) {
                state.selectedPlan = planId;
                if (!state.planDetails) {
                    console.error("Selected plan not found:", planId);
                    return;
                }
                showToast(`${state.planDetails.name} added to order!`);
                
                setTimeout(() => {
                    state.currentStep = 1;
                    checkoutContainer.classList.remove('hidden');
                    successMessage.classList.add('hidden');
                    populateOrderSummary();
                    updateCheckoutUI();
                    checkoutSection.classList.remove('hidden');
                    checkoutSection.scrollIntoView({ behavior: 'smooth' });
                }, 500); // Wait for toast to be visible before scrolling
            }

            function resetCheckout() {
                form.reset();
                Object.values(masks).forEach(mask => mask.updateValue());
                form.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));
                form.querySelectorAll('.error-message').forEach(el => el.style.display = 'none');
                
                state.selectedPlan = null;
                state.currentStep = 1;
                
                checkoutSection.classList.add('hidden');
                checkoutContainer.classList.remove('hidden');
                successMessage.classList.add('hidden');
            }

            purchaseButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    showCheckout(e.currentTarget.dataset.plan);
                });
            });

            form.addEventListener('click', (e) => {
                const targetId = e.target.id;
                if (targetId === 'to-step-2') {
                    if (validateStep(1)) { state.currentStep = 2; updateCheckoutUI(); }
                } else if (targetId === 'to-step-3') {
                    if (validateStep(2)) { state.currentStep = 3; populateConfirmation(); updateCheckoutUI(); }
                } else if (targetId === 'back-to-step-1') {
                    state.currentStep = 1; updateCheckoutUI();
                } else if (targetId === 'back-to-step-2') {
                    state.currentStep = 2; updateCheckoutUI();
                }
            });

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                if (state.currentStep !== 3) return;

                const purchaseBtn = document.getElementById('confirm-purchase');
                const btnText = purchaseBtn.querySelector('.btn-text');
                const spinner = purchaseBtn.querySelector('.spinner');

                purchaseBtn.disabled = true;
                btnText.classList.add('hidden');
                spinner.classList.remove('hidden');

                setTimeout(() => {
                    checkoutContainer.classList.add('hidden');
                    successMessage.classList.remove('hidden');
                }, 1500);
            });
            
            document.getElementById('reset-checkout-btn').addEventListener('click', resetCheckout);

            // --- Subscription Toggle Logic ---
            const subToggle = document.getElementById('subscription-toggle');
            if (subToggle) {
                const monthlyPrices = document.getElementById('monthly-prices');
                const biweeklyPrices = document.getElementById('biweekly-prices');
                const monthlyLabel = document.querySelector('label[for="sub-toggle-monthly"]');
                const biweeklyLabel = document.querySelector('label[for="sub-toggle-biweekly"]');

                subToggle.addEventListener('change', (e) => {
                    if (e.target.id === 'sub-toggle-monthly') {
                        monthlyPrices.classList.remove('hidden');
                        biweeklyPrices.classList.add('hidden');
                        monthlyLabel.classList.add('active');
                        biweeklyLabel.classList.remove('active');
                    } else if (e.target.id === 'sub-toggle-biweekly') {
                        monthlyPrices.classList.add('hidden');
                        biweeklyPrices.classList.remove('hidden');
                        monthlyLabel.classList.remove('active');
                        biweeklyLabel.classList.add('active');
                    }
                });
            }
        }

        function initMobileMenu() {
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                });
            }
        }

        // --- Initialize All Components ---
        initVideoRotator();
        initTestimonialCarousel();
        initFaqAccordion();
        initCheckout();
        initMobileMenu();
    });
    </script>
</body>
</html>
